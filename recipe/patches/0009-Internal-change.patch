From 304613a242044c30f4d2a53cf5be31e79a37aec9 Mon Sep 17 00:00:00 2001
From: Tree Contributor <noreply@google.com>
Date: Fri, 25 Jun 2021 07:47:43 -0700
Subject: [PATCH 09/20] Internal change.

PiperOrigin-RevId: 381469641
---
 tree/tree_test.py | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/tree/tree_test.py b/tree/tree_test.py
index 104deb7..7d0370e 100644
--- a/tree/tree_test.py
+++ b/tree/tree_test.py
@@ -1066,6 +1066,25 @@ class NestTest(parameterized.TestCase):
     expected = Bar(3)
     self.assertEqual(summed, expected)
 
+  def testMapStructureAcrossSubtreesListTuple(self):
+    # Tuples and lists can be used interchangeably between shallow structure
+    # and input structures. Output takes on type of the shallow structure
+    shallow = [1, (1,)]
+    deep1 = [1, [2, 3]]
+    deep2 = [2, [3, 4]]
+    summed = tree.map_structure_up_to(shallow, lambda *args: sum(args), deep1,
+                                      deep2)
+    expected = [3, (5,)]
+    self.assertEqual(summed, expected)
+
+    shallow = [1, [1]]
+    deep1 = [1, (2, 3)]
+    deep2 = [2, (3, 4)]
+    summed = tree.map_structure_up_to(shallow, lambda *args: sum(args), deep1,
+                                      deep2)
+    expected = [3, [5]]
+    self.assertEqual(summed, expected)
+
   def testNoneNodeIncluded(self):
     structure = ((1, None))
     self.assertEqual(tree.flatten(structure), [1, None])
-- 
2.25.1

