From 7895f84a7d0ab034ceb17b8f9dfa9508784593aa Mon Sep 17 00:00:00 2001
From: Rishabh Kabra <rkabra@google.com>
Date: Fri, 25 Jun 2021 08:46:01 -0700
Subject: [PATCH 10/20] Add tree recipe to broadcast a value across a reference
 structure.

PiperOrigin-RevId: 381478515
---
 docs/recipes.rst | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)

diff --git a/docs/recipes.rst b/docs/recipes.rst
index 346072e..8cec8cf 100644
--- a/docs/recipes.rst
+++ b/docs/recipes.rst
@@ -6,14 +6,14 @@ Recipes
 Concatenate nested array structures
 ===================================
 >>> tree.map_structure(lambda *args: np.concatenate(args, axis=1),
-...                                   {'a': np.ones((2, 1))},
-...                                   {'a': np.zeros((2, 1))})
+...                    {'a': np.ones((2, 1))},
+...                    {'a': np.zeros((2, 1))})
 {'a': array([[1., 0.],
        [1., 0.]])}
 
 >>> tree.map_structure(lambda *args: np.concatenate(args, axis=0),
-...                                   {'a': np.ones((2, 1))},
-...                                   {'a': np.zeros((2, 1))})
+...                    {'a': np.ones((2, 1))},
+...                    {'a': np.zeros((2, 1))})
 {'a': array([[1.],
        [1.],
        [0.],
@@ -27,3 +27,11 @@ Exclude "meta" keys while mapping across structures
 >>> d3 = {'a': 3}
 >>> tree.map_structure_up_to({'a': True}, lambda x, y, z: x+y+z, d1, d2, d3)
 {'a': 6}
+
+
+Broadcast a value across a reference structure
+==============================================
+>>> reference_tree = {'a': 1, 'b': (2, 3)}
+>>> value = np.inf
+>>> tree.map_structure(lambda _: value, reference_tree)
+{'a': inf, 'b': (inf, inf)}
-- 
2.25.1

